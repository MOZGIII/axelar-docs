# Express

## Overview

Axelar's Express Service allows for interchain [GMP](https://docs.axelar.dev/dev/general-message-passing/overview) transactions to execute significantly quicker than regular gmp transactions. It does so by executing the transaction on the destination chain before the transaction on the source chain is completely finalized. By bypassing the (sometimes) long wait time for [source chain finality](https://docs.axelar.dev/learn/txduration), overall interchain transaction speed is significantly increased.

## Users

Currently, the [Squid](https://www.squidrouter.com/) and [Sugarcane](https://www.sugarcane.app/) protocols are both operating with Axelar Express. In this example you can see the difference integrating with express makes. This [non-express transaction](https://axelarscan.io/gmp/0xc3653cda8535c59e0418b57250c504528a493dd5556fc4cb71b80f8c0a867e62:2) from Linea to Polygon took 28 minutes to execute, whereas [this](https://axelarscan.io/gmp/0x4dbf091ebf31157bf73995c0fb473f115888bd1f11793359807d543ada03f021:11) transaction using express executes from the same two chains was able to execute in just 18 seconds.


## Integration

To integrate with Express, protocols must be onboarded in coordination with the Axelar team. It is not enough to simply integrate with the relevant express contracts and expect transactions to go through the express service.

1. Each protocol that wants to be onboarded onto express [must provide funding](#funding) to assume any [risks](#risks) for the express transaction. 
2. Once liquidity is provided the contract must inherit [from either](#axelar-executable-vs-axelar-valued-express-executable) the [AxelarExpressExecutable](https://github.com/axelarnetwork/axelar-gmp-sdk-solidity/blob/main/contracts/express/AxelarExpressExecutable.sol) or the [AxelarValuedExpressExecutable](https://github.com/axelarnetwork/axelar-gmp-sdk-solidity/blob/main/contracts/express/AxelarValuedExpressExecutable.sol). 
3. Provide required info for onboarding
    - The address of the contract integrating with express
    - The assets needed to be express from that contract
        - The maximum amount they expect to be expressed in a single call
        - The maximum amount they expect to be expressed in a 30 minute window
    - The EVM chains that express transactions will be enabled for

## How it Works

To allow for faster transactions. Express transactions execute on the destination chain before finalizing on the source chain. To do so Axelar Express transactions use a separate Express Relayer.


## Axelar Executable vs. Axelar Valued Express Executable
review this thread!: https://interoplabs.slack.com/archives/C039EFMTN59/p1697664836862679

For protocols that require express support for arbitrary GMP messages where the value of the payload can alter the state of the contract the Axelar Valued Express Executable can be used. For the Valued Express Executable you need to call the `contractCallWithTokenValue()` or `callContractValue()` function to trigger your interchain transaction. These functions will return the value that the call is worth. If `tokenAddress` is `0`, then value is in terms of the native token, otherwise it's in terms of the token address.

## Fees

Express transactions require an additional [fee](https://docs.axelar.dev/dev/reference/pricing#callcontractwithtokenexpress-gmp-express) in addition to existing gmp fees. The extra fee goes to the express relayer for assuming the risk of an express transaction. 
{/* TODO confirm $1 with team */}

### Gas Estimation
When estimating gas for an interchain transaction the [estimateGasFee](https://docs.axelar.dev/dev/axelarjs-sdk/axelar-query-api#estimategasfee) function is available to provide the estimated cost. The same function can be used to estimate gas costs for an express transaction. However, for express you also need to specify several options to specify an accurate gas estimation.
For example an express transaction going from Polygon to Avalanche;
```
await api.estimateGasFee(
    "Polygon",
    "Avalanche",
    "MATIC",
    500000,
    1.1,
    "0",
    {
      showDetailedFees: true,
      transferAmount: inputTokenAmount, // In terms of symbol, not unit denom, e.g. use 1 for 1 axlUSDC, not 1000000
      sourceContractAddress: sourceChainAddress,
      destinationContractAddress: destinationChainAddress
      tokenSymbol: "axlUSDC", //aUSDC for testnet
    } 
)
```

## Interchain Token Service
For those who are deploying interchain token via Axelar's [Interchain Token Service](https://axelar.network/its), those tokens can also be added to the Express Service to provide express transactions for those tokens.
{/* TODO expand more here! */}

## Risks

### Funding
While the Express solution is an intuitive design pattern for allowing for fast interchain transactions it is not without any risks. Namely if anything changes on the source chain from the time the transaction is sent to the time it is finalized (due to a [block reorg](https://cointelegraph.com/explained/what-is-chain-reorganization-in-blockchain-technology) for example) and the transaction on the destination chain has already executed then that could lead to lost funds on the source chain as the transaction will have been instantly executed on the destination chain. Due to the potential risk here funds will need to be provided to onboard to express. Liquidity must be provided by a party to underwrite the risk.

### Execution
On the destination chain an Axelar relayer triggers the `_execute()`/ `_executeWithToken()` function to trigger a transaction. The GMP payload being used can be assumed to be true as it passes through the [validation process](https://github.com/axelarnetwork/axelar-cgp-solidity/blob/4d01eb6ea1b5413520d9ecab804f815103021148/contracts/AxelarGateway.sol#L233) on the Axelar Gateway. In an express call however the execution on the destination chain occurs before the source chain finalizes, meaning that you cannot rely on this validation process. To mitigate, data that is being passed in you can make use of the unique [CommandId](https://github.com/axelarnetwork/axelar-core/blob/main/docs/cli/axelard_query_evm_command.md). The `CommandId` is a unique identifier, which is available on the destination chain you're transacting to. With your unique commanId you can reconstruct the message that was passed in 
{/* TODO code example */}


